<!DOCTYPE html>
<html>





<head>
  <title>Quarkus - Simplified MongoDB with Panache and Kotlin</title>
  <script id="adobe_dtm" src="https://www.redhat.com/dtm.js" type="text/javascript"></script>
  <script src="/assets/javascript/highlight.pack.js" type="text/javascript"></script>
  <META HTTP-EQUIV='X-XSS-Protection' CONTENT="1; mode=block">
  <META HTTP-EQUIV='X-Content-Type-Options' CONTENT="nosniff">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Quarkus: Supersonic Subatomic Java">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@QuarkusIO"> 
  <meta name="twitter:creator" content="@QuarkusIO">
  <meta property="og:url" content="https://quarkus.io/guides/mongodb-panache-kotlin" />
  <meta property="og:title" content="Quarkus - Simplified MongoDB with Panache and Kotlin" />
  <meta property="og:description" content="Quarkus: Supersonic Subatomic Java" />
  <meta property="og:image" content="https://quarkus.io/assets/images/quarkus_card.png" />
  
  <link rel="canonical" href="https://quarkus.io/guides/mongodb-panache-kotlin">
  <link rel="shortcut icon" type="image/png" href="/favicon.ico" >
  <link rel="stylesheet" href="/guides/stylesheet/config.css" />
  <link rel="stylesheet" href="/assets/css/main.css" />
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous">
  <link rel="alternate" type="application/rss+xml"  href="/feed.xml" title="Quarkus">
  <script src="/assets/javascript/goan.js" type="text/javascript"></script>
  <script src="/assets/javascript/hl.js" type="text/javascript"></script>
</head>

<body class="guides">
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NJWS5L"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

  <div class="nav-wrapper">
  <div class="grid-wrapper">
    <div class="width-12-12">
      <input type="checkbox" id="checkbox" />
      <nav id="main-nav" class="main-nav">
  <div class="container">
    <div class="logo-wrapper">
      
        <a href="/"><img src="/assets/images/quarkus_logo_horizontal_rgb_600px_reverse.png" class="project-logo" title="Quarkus"></a>
      
    </div>
    <label class="nav-toggle" for="checkbox">
      <i class="fa fa-bars"></i>
    </label>
    <div id="menu" class="menu">
      <span>
        <a href="/get-started/" class="">はじめに</a>
      </span>
      <span>
        <a href="/guides/" class="active">ガイド</a>
      </span>
      <span>
        <a href="/community/" class="">コミュニティ</a>
      </span>
      <span>
        <a href="/support/" class="">サポート</a>
      </span>
      <span>
        <a href="/blog/" class="">ブログ</a>
      </span>
      <span>
        <a href="https://code.quarkus.io" class="button-cta secondary white">コーディングを開始</a>
      </span>
    </div>
  </div>
      </nav>
    </div>
  </div>
</div>

  <div class="content">
    


<div class="grid-wrapper guide">
  <div class="grid__item width-9-12 width-12-12-mobile">
    <h1 class="text-caps">Quarkus - Simplified MongoDB with Panache and Kotlin </h1>
  </div>
  <div class="grid__item width-3-12 align-self-center text-right hide-mobile">
    <label id="guide-version-label">Select Guide Version</label>
    <select id="guide-version-dropdown">
      
        
        
        
        
          <option value="main" >Main - SNAPSHOT</option>
        
      
        
        
        
        
          <option value="latest" selected>2.0 - Latest</option>
        
      
        
        
        
        
      
        
        
        
        
      
    </select>
  </div>
  <div class="width-12-12">
    <div class="hide-mobile toc"><ul class="sectlevel1">
<li><a href="#最初に例">最初に:例</a></li>
<li><a href="#リポジトリパターンの使用">リポジトリパターンの使用</a>
<ul class="sectlevel2">
<li><a href="#エンティティの定義">エンティティの定義</a></li>
<li><a href="#リポジトリの定義">リポジトリの定義</a></li>
<li><a href="#最も便利な操作">最も便利な操作</a></li>
</ul>
</li>
<li><a href="#setting-up-and-configuring-mongodb-with-panache">Setting up and configuring MongoDB with Panache</a></li>
</ul></div>
    <div>
      <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>MongoDB is a well known NoSQL Database that is widely used. MongoDB with
Panache offers a new layer atop this familiar framework.  This guide will
not dive in to the specifics of either as those are already covered in the
<a href="mongodb-panache">MongoDB with Panache guide</a>.  In this guide, we&#8217;ll
cover the Kotlin specific changes needed to use MongoDB with Panache in your
Kotlin-based Quarkus applications.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="最初に例"><a class="anchor" href="#最初に例"></a>最初に:例</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As we saw in the MongoDB with Panache guide, it allows us to extend the
functionality in our entities and repositories (also known as DAOs) with
some automatically provided functionality.  When using Kotlin, the approach
is very similar to what we see in the Java version with a slight change or
two.  To Panache-enable your entity, you would define it something like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">class Person: PanacheMongoEntity {
    lateinit var name: String
    lateinit var birth: LocalDate
    lateinit var status: Status
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>ご覧のように、私たちのエンティティーはシンプルなままです。しかし、Java版とは少し違いがあります。Kotlin 言語は Java
のように静的メソッドの概念をサポートしていません。その代わり、
<a href="https://kotlinlang.org/docs/tutorials/kotlin-for-py/objects-and-companion-objects.html#companion-objects">コンパニオンオブジェクト</a>
を使わなければなりません。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">class Person : PanacheMongoEntity() {
    companion object: PanacheCompanion&lt;Person&gt; {  <i class="conum" data-value="1"></i><b>(1)</b>
        fun findByName(name: String) = find("name", name).firstResult()
        fun findAlive() = list("status", Status.Alive)
        fun deleteStefs() = delete("name", "Stef")
    }

    lateinit var name: String  <i class="conum" data-value="2"></i><b>(2)</b>
    lateinit var birth: LocalDate
    lateinit var status: Status
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>コンパニオンオブジェクトは、特定のインスタンスに関連しないすべてのメソッドを保持し、特定の型にバインドされた一般的な管理とクエリを可能にします。</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Here there are options, but we&#8217;ve chosen the <code>lateinit</code> approach.  This
allows us to declare these fields as non-null knowing they will be properly
assigned either by the constructor (not shown) or by the MongoDB POJO codec
loading data from the database.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
These types differ from the Java types mentioned in those tutorials.  For
Kotlin support, all the Panache types will be found in the
<code>io.quarkus.mongodb.panache.kotlin</code> package.  This subpackage allows for the
distinction between the Java and Kotlin variants and allows for both to be
used unambiguously in a single project.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Kotlin版では、単純に
<a href="https://www.martinfowler.com/eaaCatalog/activeRecord.html"><code>active
record pattern</code></a> の機能を <code>companion object</code>
に追加しました。このわずかな変更を別にすれば、私たちは、世界のJava側から簡単にマップする方法で私たちの型を使用して作業することができます。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="リポジトリパターンの使用"><a class="anchor" href="#リポジトリパターンの使用"></a>リポジトリパターンの使用</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="エンティティの定義"><a class="anchor" href="#エンティティの定義"></a>エンティティの定義</h3>
<div class="paragraph">
<p>When using the repository pattern, you can define your entities as regular
POJO.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">class Person {
    var id: ObjectId? = null; // used by MongoDB for the _id field
    lateinit var name: String
    lateinit var birth: LocalDate
    lateinit var status: Status
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="リポジトリの定義"><a class="anchor" href="#リポジトリの定義"></a>リポジトリの定義</h3>
<div class="paragraph">
<p>When using Repositories, you get the exact same convenient methods as with
the active record pattern, injected in your Repository, by making them
implement <code>PanacheMongoRepository</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">@ApplicationScoped
class PersonRepository: PanacheMongoRepository&lt;Person&gt; {
     fun findByName(name: String) = find("name", name).firstResult()
     fun findAlive() = list("status", Status.Alive)
     fun deleteStefs() = delete("name", "Stef")
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>All the operations that are defined on <code>PanacheMongoEntityBase</code> are
available on your repository, so using it is exactly the same as using the
active record pattern, except you need to inject it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">@Inject
lateinit var personRepository: PersonRepository

@GET
fun count() = personRepository.count()</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="最も便利な操作"><a class="anchor" href="#最も便利な操作"></a>最も便利な操作</h3>
<div class="paragraph">
<p>リポジトリを書くことで実行可能な最も一般的な操作は以下の通りです。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">// creating a person
var person = Person()
person.name = "Stef"
person.birth = LocalDate.of(1910, Month.FEBRUARY, 1)
person.status = Status.Alive

// persist it: if you keep the default ObjectId ID field, it will be populated by the MongoDB driver
personRepository.persist(person)

person.status = Status.Dead;

// Your must call update() in order to send your entity modifications to MongoDB
personRepository.update(person);


// delete it
personRepository.delete(person);

// getting a list of all Person entities
val allPersons = personRepository.listAll()

// finding a specific person by ID
// here we build a new ObjectId but you can also retrieve it from the existing entity after being persisted
ObjectId personId = new ObjectId(idAsString);
person = personRepository.findById(personId) ?: throw Exception("No person with that ID")

// finding all living persons
val livingPersons = personRepository.list("status", Status.Alive)

// counting all persons
val countAll = personRepository.count()

// counting all living persons
val countAlive = personRepository.count("status", Status.Alive)

// delete all living persons
personRepository.delete("status", Status.Alive)

// delete all persons
personRepository.deleteAll()

// delete by id
val deleted = personRepository.deleteById(personId)

// set the name of all living persons to 'Mortal'
personRepository.update("name = 'Mortal' where status = ?1", Status.Alive)</code></pre>
</div>
</div>
<div class="paragraph">
<p>すべての <code>list</code> メソッドは、同等の <code>stream</code> バージョンがあります。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">val persons = personRepository.streamAll();
val namesButEmmanuels = persons
    .map { it.name.toLowerCase() }
    .filter { it != "emmanuel" }</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more examples, please consult the <a href="mongodb-panache">Java version</a> for
complete details.  Both APIs are the same and work identically except for
some Kotlin-specific tweaks to make things feel more natural to Kotlin
developers.  These tweaks include things like better use of nullability and
the lack of <code>Optional</code> on API methods.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="setting-up-and-configuring-mongodb-with-panache"><a class="anchor" href="#setting-up-and-configuring-mongodb-with-panache"></a>Setting up and configuring MongoDB with Panache</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To get started using MongoDB with Panache with Kotlin, you can, generally,
follow the steps laid out in the Java tutorial.  The biggest change to
configuring your project is the Quarkus artifact to include.  You can, of
course, keep the Java version if you need but if all you need are the Kotlin
APIs then include the following dependency instead:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
        &lt;artifactId&gt;quarkus-mongodb-panache-kotlin&lt;/artifactId&gt;  <i class="conum" data-value="1"></i><b>(1)</b>
    &lt;/dependency&gt;
&lt;/dependencies&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>最後に <code>-kotlin</code>
が追加されていることに注意してください。一般的にはこのバージョンだけが必要ですが、もしあなたのプロジェクトがJavaとKotlinの両方のコードを使うのであれば、両方の成果物を安全に含めることができます。</td>
</tr>
</table>
</div>
</div>
</div>
    </div>
  </div>
</div>

  </div>

  <div class="content project-footer">
  <div class="footer-section">
    <div class="logo-wrapper">
      <a href="/"><img src="/assets/images/quarkus_logo_horizontal_rgb_reverse.svg" class="project-logo" title="Quarkus"></a>
    </div>
  </div>
  <div class="grid-wrapper">
    <p class="grid__item width-3-12">Quarkus はオープンです。このプロジェクトの全ての依存関係は<a href='https://www.apache.org/licenses/LICENSE-2.0' target='_blank'>Apache Software License 2.0</a>または互換性のあるライセンスの元で利用出来ます。<br /><br />このウェブサイトは <a href='https://jekyllrb.com/' target='_blank'>Jekyll</a> で構築されており、<a href='https://pages.github.com/' target='_blank'>Github Pages</a>にホストされており、完全にオープンソースです。改善したい場合、 <a href='https://github.com/quarkusio/quarkusio.github.io' target='_blank'>ウェブサイトをフォークし</a>、修正してみせてください。</p>

    
      <div class="width-1-12 project-links">
        <span>ナビゲーション</span>
        <ul class="footer-links">
          
            <li><a href="/">ホーム</a></li>
          
            <li><a href="/guides">ガイド</a></li>
          
            <li><a href="/community/#contributing">貢献</a></li>
          
            <li><a href="/faq">FAQ</a></li>
          
            <li><a href="/get-started">はじめに</a></li>
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <span>貢献</span>
        <ul class="footer-links">
          
            <li><a href="https://twitter.com/quarkusio">フォロー</a></li>
          
            <li><a href="https://github.com/quarkusio">GitHub</a></li>
          
            <li><a href="/security">セキュリティポリシー</a></li>
          
        </ul>
      </div>
    
      <div class="width-2-12 project-links">
        <span>サポート</span>
        <ul class="footer-links">
          
            <li><a href="https://stackoverflow.com/questions/tagged/quarkus">Stack Overflow</a></li>
          
            <li><a href="https://quarkusio.zulipchat.com">チャットルーム</a></li>
          
            <li><a href="https://groups.google.com/forum/#!forum/quarkus-dev">フォーラム</a></li>
          
        </ul>
      </div>
    

    
      <div class="width-4-12 more-links">
        <span>Quarkusはコミュニティプロジェクトで構成されています：</span>
        <ul class="footer-links">
          
            <li><a href="https://vertx.io/" target="_blank">Eclipse Vert.x</a></li>
          
            <li><a href="https://smallrye.io" target="_blank">SmallRye</a></li>
          
            <li><a href="https://hibernate.org" target="_blank">Hibernate</a></li>
          
            <li><a href="https://netty.io" target="_blank">Netty</a></li>
          
            <li><a href="https://resteasy.github.io" target="_blank">RESTEasy</a></li>
          
            <li><a href="https://camel.apache.org" target="_blank">Apache Camel</a></li>
          
            <li><a href="https://microprofile.io" target="_blank">Eclipse MicroProfile</a></li>
          
            <li><a href="https://code.quarkus.io/" target="_blank">等々...</a></li>
          
        </ul>
      </div>
    
  </div>
</div>

  <div class="content redhat-footer">
  <div class="grid-wrapper">
    <span class="licence">
      <i class="fab fa-creative-commons"></i><i class="fab fa-creative-commons-by"></i> <a href="https://creativecommons.org/licenses/by/3.0/" target="_blank">CC by 3.0</a> | <a href="https://www.redhat.com/en/about/privacy-policy">Privacy Policy</a>
    </span>
    <span class="redhat">
      Sponsored by
    </span>
    <span class="redhat-logo">
      <a href="https://www.redhat.com/" target="_blank"><img src="/assets/images/redhat_reversed.svg"></a>
    </span>
  </div>
</div>


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js" integrity="sha384-8gBf6Y4YYq7Jx97PIqmTwLPin4hxIzQw5aDmUg/DDhul9fFpbbLcLh3nTIIDJKhx" crossorigin="anonymous"></script>
  <script type="text/javascript" src="/assets/javascript/mobile-nav.js"></script>
  <script type="text/javascript" src="/assets/javascript/scroll-down.js"></script>
  <script src="/assets/javascript/satellite.js" type="text/javascript"></script>
  <script src="/guides/javascript/config.js" type="text/javascript"></script>
  <script src="/assets/javascript/search-filter.js" type="text/javascript"></script>
  <script src="/assets/javascript/guides-version-dropdown.js" type="text/javascript"></script>
  <script src="/assets/javascript/back-to-top.js" type="text/javascript"></script>
</body>

</html>
