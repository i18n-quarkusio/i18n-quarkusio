<!DOCTYPE html>
<html>





<head>
  <title>Quarkus - Quarkus Extension for Spring Scheduling API</title>
  <script id="adobe_dtm" src="https://www.redhat.com/dtm.js" type="text/javascript"></script>
  <script src="/assets/javascript/highlight.pack.js" type="text/javascript"></script>
  <META HTTP-EQUIV='X-XSS-Protection' CONTENT="1; mode=block">
  <META HTTP-EQUIV='X-Content-Type-Options' CONTENT="nosniff">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Quarkus: Supersonic Subatomic Java">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@QuarkusIO"> 
  <meta name="twitter:creator" content="@QuarkusIO">
  <meta property="og:url" content="https://quarkus.io/guides/spring-scheduled" />
  <meta property="og:title" content="Quarkus - Quarkus Extension for Spring Scheduling API" />
  <meta property="og:description" content="Quarkus: Supersonic Subatomic Java" />
  <meta property="og:image" content="https://quarkus.io/assets/images/quarkus_card.png" />
  
  <link rel="canonical" href="https://quarkus.io/guides/spring-scheduled">
  <link rel="shortcut icon" type="image/png" href="/favicon.ico" >
  <link rel="stylesheet" href="/guides/stylesheet/config.css" />
  <link rel="stylesheet" href="/assets/css/main.css" />
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous">
  <link rel="alternate" type="application/rss+xml"  href="/feed.xml" title="Quarkus">
  <script src="/assets/javascript/goan.js" type="text/javascript"></script>
  <script src="/assets/javascript/hl.js" type="text/javascript"></script>
</head>

<body class="guides">
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NJWS5L"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

  <div class="nav-wrapper">
  <div class="grid-wrapper">
    <div class="width-12-12">
      <input type="checkbox" id="checkbox" />
      <nav id="main-nav" class="main-nav">
  <div class="container">
    <div class="logo-wrapper">
      
        <a href="/"><img src="/assets/images/quarkus_logo_horizontal_rgb_600px_reverse.png" class="project-logo" title="Quarkus"></a>
      
    </div>
    <label class="nav-toggle" for="checkbox">
      <i class="fa fa-bars"></i>
    </label>
    <div id="menu" class="menu">
      <span>
        <a href="/get-started/" class="">はじめに</a>
      </span>
      <span>
        <a href="/guides/" class="active">ガイド</a>
      </span>
      <span>
        <a href="/community/" class="">コミュニティ</a>
      </span>
      <span>
        <a href="/support/" class="">サポート</a>
      </span>
      <span>
        <a href="/blog/" class="">ブログ</a>
      </span>
      <span>
        <a href="https://code.quarkus.io" class="button-cta secondary white">コーディングを開始</a>
      </span>
    </div>
  </div>
      </nav>
    </div>
  </div>
</div>

  <div class="content">
    


<div class="grid-wrapper guide">
  <div class="grid__item width-9-12 width-12-12-mobile">
    <h1 class="text-caps">Quarkus - Quarkus Extension for Spring Scheduling API </h1>
  </div>
  <div class="grid__item width-3-12 align-self-center text-right hide-mobile">
    <label id="guide-version-label">Select Guide Version</label>
    <select id="guide-version-dropdown">
      
        
        
        
        
          <option value="main" >Main - SNAPSHOT</option>
        
      
        
        
        
        
          <option value="latest" selected>2.0 - Latest</option>
        
      
        
        
        
        
          <option value="1.11" >1.11</option>
        
      
        
        
        
        
          <option value="1.7" >1.7</option>
        
      
    </select>
  </div>
  <div class="width-12-12">
    <div class="hide-mobile toc"><ul class="sectlevel1">
<li><a href="#前提条件">前提条件</a></li>
<li><a href="#ソリューション">ソリューション</a></li>
<li><a href="#mavenプロジェクトの作成">Mavenプロジェクトの作成</a></li>
<li><a href="#creating-a-scheduled-job">Creating a scheduled job</a></li>
<li><a href="#updating-the-application-configuration-file">Updating the application configuration file</a></li>
<li><a href="#updating-the-resource-and-the-test">Updating the resource and the test</a></li>
<li><a href="#アプリケーションをパッケージ化して実行する">アプリケーションをパッケージ化して実行する</a></li>
<li><a href="#using-property-expressions">Using Property Expressions</a></li>
<li><a href="#unsupported-spring-scheduled-functionalities">Unsupported Spring Scheduled functionalities</a></li>
<li><a href="#important-technical-note">Important Technical Note</a></li>
<li><a href="#more-spring-guides">More Spring guides</a></li>
</ul></div>
    <div>
      <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>While users are encouraged to use <a href="scheduler#standard-scheduling">regular
Quarkus scheduler</a>, Quarkus provides a compatibility layer for Spring
Scheduled in the form of the <code>spring-scheduled</code> extension.</p>
</div>
<div class="paragraph">
<p>This guide explains how a Quarkus application can leverage the well known
Spring Scheduled annotation to configure and schedule tasks.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="前提条件"><a class="anchor" href="#前提条件"></a>前提条件</h2>
<div class="sectionbody">
<div class="paragraph">
<p>このガイドを完成させるには、以下が必要です:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>15分未満</p>
</li>
<li>
<p>IDE</p>
</li>
<li>
<p>JDK 11+ installed with <code>JAVA_HOME</code> configured appropriately</p>
</li>
<li>
<p>Apache Maven 3.8.1+</p>
</li>
<li>
<p>Some familiarity with the Spring Web extension</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ソリューション"><a class="anchor" href="#ソリューション"></a>ソリューション</h2>
<div class="sectionbody">
<div class="paragraph">
<p>次の章で紹介する手順に沿って、ステップを踏んでアプリを作成することをお勧めします。ただし、完成した例にそのまま進んでも構いません。</p>
</div>
<div class="paragraph">
<p>Gitレポジトリをクローンするか <code>git clone <a href="https://github.com/quarkusio/quarkus-quickstarts.git" class="bare">https://github.com/quarkusio/quarkus-quickstarts.git</a></code> 、
<a href="https://github.com/quarkusio/quarkus-quickstarts/archive/main.zip">アーカイブ</a> をダウンロードします。</p>
</div>
<div class="paragraph">
<p>The solution is located in the <code>spring-scheduled-quickstart</code>
<a href="https://github.com/quarkusio/quarkus-quickstarts/tree/main/spring-scheduled-quickstart">directory</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="mavenプロジェクトの作成"><a class="anchor" href="#mavenプロジェクトの作成"></a>Mavenプロジェクトの作成</h2>
<div class="sectionbody">
<div class="paragraph">
<p>まず、新しいプロジェクトが必要です。以下のコマンドで新規プロジェクトを作成します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">mvn io.quarkus:quarkus-maven-plugin:2.0.2.Final:create \
    -DprojectGroupId=org.acme \
    -DprojectArtifactId=spring-scheduler-quickstart \
    -DclassName="org.acme.spring.scheduler.CountResource" \
    -Dpath="/count" \
    -Dextensions="resteasy,spring-scheduled"
cd spring-scheduler-quickstart</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command generates a Maven project with a REST endpoint and adds the
<code>spring-scheduled</code> extension.</p>
</div>
<div class="paragraph">
<p>If you already have your Quarkus project configured, you can add the
<code>spring-scheduled</code> extension to your project by running the following
command in your project base directory:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./mvnw quarkus:add-extension -Dextensions="spring-scheduled"</code></pre>
</div>
</div>
<div class="paragraph">
<p>これにより、 <code>pom.xml</code> に以下が追加されます:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
    &lt;artifactId&gt;quarkus-spring-scheduled&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="creating-a-scheduled-job"><a class="anchor" href="#creating-a-scheduled-job"></a>Creating a scheduled job</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the <code>org.acme.spring.scheduler</code> package, create the <code>CounterBean</code> class,
with the following content:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.acme.spring.scheduler;

import org.springframework.scheduling.annotation.Scheduled;

import java.util.concurrent.atomic.AtomicInteger;
import javax.enterprise.context.ApplicationScoped;

@ApplicationScoped              <i class="conum" data-value="1"></i><b>(1)</b>
public class CounterBean {

    private AtomicInteger counter = new AtomicInteger();

    public int get() {   <i class="conum" data-value="2"></i><b>(2)</b>
        return counter.get();
    }

    @Scheduled(cron="*/5 * * * * ?")   <i class="conum" data-value="3"></i><b>(3)</b>
    void cronJob() {
        counter.incrementAndGet();      <i class="conum" data-value="4"></i><b>(4)</b>
        System.out.println("Cron expression hardcoded");
    }

    @Scheduled(cron = "{cron.expr}")   <i class="conum" data-value="5"></i><b>(5)</b>
    void cronJobWithExpressionInConfig() {
        counter.incrementAndGet();
        System.out.println("Cron expression configured in application.properties");
    }

    @Scheduled(fixedRate = 1000)    <i class="conum" data-value="6"></i><b>(6)</b>
    void jobAtFixedRate() {
        counter.incrementAndGet();
        System.out.println("Fixed Rate expression");
    }

    @Scheduled(fixedRateString = "${fixedRate.expr}")      <i class="conum" data-value="7"></i><b>(7)</b>
    void jobAtFixedRateInConfig() {
        counter.incrementAndGet();
        System.out.println("Fixed Rate expression configured in application.properties");
    }
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Declare the bean in the <em>application</em> scope. Spring only detects @Scheduled
annotations in beans.</p>
</li>
<li>
<p>The <code>get()</code> method allows retrieving the current value.</p>
</li>
<li>
<p>Use the Spring <code>@Scheduled</code> annotation with a cron-like expression to
instruct Quarkus to schedule this method run.  In this example we&#8217;re
scheduling a task to be executed at 10:15am every day.</p>
</li>
<li>
<p>The code is pretty straightforward. Every day at 10:15am, the counter is
incremented.</p>
</li>
<li>
<p>Define a job with a cron-like expression <code>cron.expr</code> which is configurable
in <code>application.properties</code>.</p>
</li>
<li>
<p>Define a method to be executed at a fixed interval of time. The period is
expressed in milliseconds.</p>
</li>
<li>
<p>Define a job to be executed at a fixed interval of time <code>fixedRate.expr</code>
which is configurable in <code>application.properties</code>.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="updating-the-application-configuration-file"><a class="anchor" href="#updating-the-application-configuration-file"></a>Updating the application configuration file</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Edit the <code>application.properties</code> file and add the <code>cron.expr</code> and the
<code>fixedRate.expr</code> configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties"># The syntax used by Spring for cron expressions is the same as which is used by regular Quarkus scheduler.
cron.expr=*/5 * * * * ?
fixedRate.expr=1000</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="updating-the-resource-and-the-test"><a class="anchor" href="#updating-the-resource-and-the-test"></a>Updating the resource and the test</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Edit the <code>CountResource</code> class, and update the content to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.acme.spring.scheduler;

import javax.inject.Inject;
import javax.ws.rs.GET;
import javax.ws.rs.Path;
import javax.ws.rs.Produces;
import javax.ws.rs.core.MediaType;

@Path("/count")
public class CountResource {

    @Inject
    CounterBean counter;    <i class="conum" data-value="1"></i><b>(1)</b>


    @GET
    @Produces(MediaType.TEXT_PLAIN)
    public String hello() {
        return "count: " + counter.get();   <i class="conum" data-value="2"></i><b>(2)</b>
    }
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Inject the <code>CounterBean</code></p>
</li>
<li>
<p>Send back the current counter value</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>We also need to update the tests. Edit the <code>CountResourceTest</code> class to
match:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.acme.spring.scheduler;

import static io.restassured.RestAssured.given;
import static org.hamcrest.CoreMatchers.containsString;

import org.junit.jupiter.api.Test;

import io.quarkus.test.junit.QuarkusTest;

@QuarkusTest
public class CountResourceTest {

    @Test
    public void testHelloEndpoint() {
        given()
                .when().get("/count")
                .then()
                .statusCode(200)
                .body(containsString("count"));  <i class="conum" data-value="1"></i><b>(1)</b>
    }

}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that the response contains <code>count</code></p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="アプリケーションをパッケージ化して実行する"><a class="anchor" href="#アプリケーションをパッケージ化して実行する"></a>アプリケーションをパッケージ化して実行する</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Run the application with: <code>./mvnw compile quarkus:dev</code>.  In another
terminal, run <code>curl localhost:8080/count</code> to check the counter value.  After
a few seconds, re-run <code>curl localhost:8080/count</code> to verify the counter has
been incremented.</p>
</div>
<div class="paragraph">
<p>Observe the console to verify that the following messages has been
displayed:
- <code>Cron expression hardcoded</code>
- <code>Cron expression configured in application.properties</code>
- <code>Fixed Rate expression</code>
- <code>Fixed Rate expression configured in application.properties</code> These messages
  indicate that the executions of methods annotated with <code>@Scheduled</code> have
  been triggered.</p>
</div>
<div class="paragraph">
<p>As usual, the application can be packaged using <code>./mvnw clean package</code> and
executed using the <code>target/quarkus-app/quarkus-run.jar</code> file.  You can also
generate the native executable with <code>./mvnw clean package -Pnative</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-property-expressions"><a class="anchor" href="#using-property-expressions"></a>Using Property Expressions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Quarkus supports the use of property expressions in the
<code>application.properties</code> file so to externalize the configuration of the
tasks you should store the properties in the <code>application.properties</code> file
and use the <code>fixedRateString</code>, <code>initialDelayString</code> params respectively.</p>
</div>
<div class="paragraph">
<p>Note that this configuration is a build time configuration, the property
expression will be resolved at build time.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="unsupported-spring-scheduled-functionalities"><a class="anchor" href="#unsupported-spring-scheduled-functionalities"></a>Unsupported Spring Scheduled functionalities</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Quarkus currently only supports a subset of the functionalities that Spring
@Scheduled provides with more features being planned.  Currently, the
<code>fixedDelay</code> and <code>fixedDelayString</code> parameters are not supported, in other
words, <code>@Scheduled</code> methods are always executed independently.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="important-technical-note"><a class="anchor" href="#important-technical-note"></a>Important Technical Note</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Please note that the Spring support in Quarkus does not start a Spring
Application Context nor are any Spring infrastructure classes run.  Spring
classes and annotations are only used for reading metadata and / or are used
as user code method return types or parameter types.  What that means for
end users, is that adding arbitrary Spring libraries will not have any
effect. Moreover Spring infrastructure classes (like
<code>org.springframework.beans.factory.config.BeanPostProcessor</code> for example)
will not be executed.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="more-spring-guides"><a class="anchor" href="#more-spring-guides"></a>More Spring guides</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Quarkus has more Spring compatibility features. See the following guides for
more details:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="spring-di">Quarkus - Spring DIのためのエクステンション</a></p>
</li>
<li>
<p><a href="spring-web">Quarkus - Spring Webのためのエクステンション</a></p>
</li>
<li>
<p><a href="spring-data-jpa">Quarkus - Spring Data JPAのためのエクステンション</a></p>
</li>
<li>
<p><a href="spring-data-rest">Quarkus - Spring Data RESTのためのエクステンション</a></p>
</li>
<li>
<p><a href="spring-cloud-config-client">Quarkus - Spring Cloud Config
Serverからプロパティーを読み込む</a></p>
</li>
<li>
<p><a href="spring-boot-properties">Quarkus - Spring Bootプロパティーのためのエクステンション</a></p>
</li>
<li>
<p><a href="spring-cache">Quarkus - Spring Cacheのためのエクステンション</a></p>
</li>
<li>
<p><a href="spring-security">Quarkus - Spring Securityのためのエクステンション</a></p>
</li>
</ul>
</div>
</div>
</div>
    </div>
  </div>
</div>

  </div>

  <div class="content project-footer">
  <div class="footer-section">
    <div class="logo-wrapper">
      <a href="/"><img src="/assets/images/quarkus_logo_horizontal_rgb_reverse.svg" class="project-logo" title="Quarkus"></a>
    </div>
  </div>
  <div class="grid-wrapper">
    <p class="grid__item width-3-12">Quarkus はオープンです。このプロジェクトの全ての依存関係は<a href='https://www.apache.org/licenses/LICENSE-2.0' target='_blank'>Apache Software License 2.0</a>または互換性のあるライセンスの元で利用出来ます。<br /><br />このウェブサイトは <a href='https://jekyllrb.com/' target='_blank'>Jekyll</a> で構築されており、<a href='https://pages.github.com/' target='_blank'>Github Pages</a>にホストされており、完全にオープンソースです。改善したい場合、 <a href='https://github.com/quarkusio/quarkusio.github.io' target='_blank'>ウェブサイトをフォークし</a>、修正してみせてください。</p>

    
      <div class="width-1-12 project-links">
        <span>ナビゲーション</span>
        <ul class="footer-links">
          
            <li><a href="/">ホーム</a></li>
          
            <li><a href="/guides">ガイド</a></li>
          
            <li><a href="/community/#contributing">貢献</a></li>
          
            <li><a href="/faq">FAQ</a></li>
          
            <li><a href="/get-started">はじめに</a></li>
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <span>貢献</span>
        <ul class="footer-links">
          
            <li><a href="https://twitter.com/quarkusio">フォロー</a></li>
          
            <li><a href="https://github.com/quarkusio">GitHub</a></li>
          
            <li><a href="/security">セキュリティポリシー</a></li>
          
        </ul>
      </div>
    
      <div class="width-2-12 project-links">
        <span>サポート</span>
        <ul class="footer-links">
          
            <li><a href="https://stackoverflow.com/questions/tagged/quarkus">Stack Overflow</a></li>
          
            <li><a href="https://quarkusio.zulipchat.com">チャットルーム</a></li>
          
            <li><a href="https://groups.google.com/forum/#!forum/quarkus-dev">フォーラム</a></li>
          
        </ul>
      </div>
    

    
      <div class="width-4-12 more-links">
        <span>Quarkusはコミュニティプロジェクトで構成されています：</span>
        <ul class="footer-links">
          
            <li><a href="https://vertx.io/" target="_blank">Eclipse Vert.x</a></li>
          
            <li><a href="https://smallrye.io" target="_blank">SmallRye</a></li>
          
            <li><a href="https://hibernate.org" target="_blank">Hibernate</a></li>
          
            <li><a href="https://netty.io" target="_blank">Netty</a></li>
          
            <li><a href="https://resteasy.github.io" target="_blank">RESTEasy</a></li>
          
            <li><a href="https://camel.apache.org" target="_blank">Apache Camel</a></li>
          
            <li><a href="https://microprofile.io" target="_blank">Eclipse MicroProfile</a></li>
          
            <li><a href="https://code.quarkus.io/" target="_blank">等々...</a></li>
          
        </ul>
      </div>
    
  </div>
</div>

  <div class="content redhat-footer">
  <div class="grid-wrapper">
    <span class="licence">
      <i class="fab fa-creative-commons"></i><i class="fab fa-creative-commons-by"></i> <a href="https://creativecommons.org/licenses/by/3.0/" target="_blank">CC by 3.0</a> | <a href="https://www.redhat.com/en/about/privacy-policy">Privacy Policy</a>
    </span>
    <span class="redhat">
      Sponsored by
    </span>
    <span class="redhat-logo">
      <a href="https://www.redhat.com/" target="_blank"><img src="/assets/images/redhat_reversed.svg"></a>
    </span>
  </div>
</div>


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js" integrity="sha384-8gBf6Y4YYq7Jx97PIqmTwLPin4hxIzQw5aDmUg/DDhul9fFpbbLcLh3nTIIDJKhx" crossorigin="anonymous"></script>
  <script type="text/javascript" src="/assets/javascript/mobile-nav.js"></script>
  <script type="text/javascript" src="/assets/javascript/scroll-down.js"></script>
  <script src="/assets/javascript/satellite.js" type="text/javascript"></script>
  <script src="/guides/javascript/config.js" type="text/javascript"></script>
  <script src="/assets/javascript/search-filter.js" type="text/javascript"></script>
  <script src="/assets/javascript/guides-version-dropdown.js" type="text/javascript"></script>
  <script src="/assets/javascript/back-to-top.js" type="text/javascript"></script>
</body>

</html>
